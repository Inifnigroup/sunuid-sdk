!function(){"use strict";function e(e,t,r,n,i,o,a){try{var u=e[o](a),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,i)}function t(t){return function(){var r=this,n=arguments;return new Promise(function(i,o){var a=t.apply(r,n);function u(t){e(a,i,o,u,s,"next",t)}function s(t){e(a,i,o,u,s,"throw",t)}u(void 0)})}}function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function n(e,t,r){return(t=s(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){n(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function a(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function o(r,n,i,o){var a=n&&n.prototype instanceof c?n:c,l=Object.create(a.prototype);return u(l,"_invoke",function(r,n,i){var o,a,u,c=0,l=i||[],f=!1,h={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return o=t,a=0,u=e,h.n=r,s}};function p(r,n){for(a=r,u=n,t=0;!f&&c&&!i&&t<l.length;t++){var i,o=l[t],p=h.p,d=o[2];r>3?(i=d===n)&&(u=o[(a=o[4])?5:(a=3,3)],o[4]=o[5]=e):o[0]<=p&&((i=r<2&&p<o[1])?(a=0,h.v=n,h.n=o[1]):p<d&&(i=r<3||o[0]>n||n>d)&&(o[4]=r,o[5]=n,h.n=d,a=0))}if(i||r>1)return s;throw f=!0,n}return function(i,l,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,d),a=l,u=d;(t=a<2?e:u)||!f;){o||(a?a<3?(a>1&&(h.n=-1),p(a,u)):h.n=u:h.v=u);try{if(c=2,o){if(a||(i="next"),t=o[i]){if(!(t=t.call(o,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,a<2&&(a=0)}else 1===a&&(t=o.return)&&t.call(o),a<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),a=1);o=e}else if((t=(f=h.n<0)?u:r.call(n,h))!==s)break}catch(t){o=e,a=1,u=t}finally{c=1}}return{value:t,done:f}}}(r,i,o),!0),l}var s={};function c(){}function l(){}function f(){}t=Object.getPrototypeOf;var h=[][n]?t(t([][n]())):(u(t={},n,function(){return this}),t),p=f.prototype=c.prototype=Object.create(h);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,u(e,i,"GeneratorFunction")),e.prototype=Object.create(p),e}return l.prototype=f,u(p,"constructor",f),u(f,"constructor",l),l.displayName="GeneratorFunction",u(f,i,"GeneratorFunction"),u(p),u(p,i,"Generator"),u(p,n,function(){return this}),u(p,"toString",function(){return"[object Generator]"}),(a=function(){return{w:o,m:d}})()}function u(e,t,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}u=function(e,t,r,n){function o(t,r){u(e,t,function(e){return this._invoke(t,r,e)})}t?i?i(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(o("next",0),o("throw",1),o("return",2))},u(e,t,r,n)}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}
/**
   * SunuID SDK - Package d'intégration pour partenaires
   * 
   * @version 1.0.0
   * @author SunuID Team
   * @license MIT
   */!function(e){var n={apiUrl:"https://sunuid.fayma.sn/api",partnerId:null,clientId:null,secretId:null,theme:"light",language:"fr",autoRefresh:!0,refreshInterval:3e4,onSuccess:null,onError:null,onExpired:null},i=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=o(o({},n),t),this.qrCode=null,this.refreshTimer=null,this.isInitialized=!1,this.init()},i=[{key:"init",value:function(){if(!this.config.partnerId||!this.config.clientId||!this.config.secretId)throw new Error("SunuID: partnerId, clientId et secretId sont requis");this.isInitialized=!0,console.log("SunuID SDK initialisé avec succès")}},{key:"generateAuthQR",value:(h=t(a().m(function e(t){var r,n,i,u=arguments;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=u.length>1&&void 0!==u[1]?u[1]:{},this.isInitialized){e.n=1;break}throw new Error("SunuID: SDK non initialisé");case 1:return e.p=1,e.n=2,this.makeRequest("/auth/qr-generate.php",o({type:"auth"},r));case 2:if(!(n=e.v).success){e.n=3;break}return this.displayQRCode(t,n.data.qrCodeUrl,"auth",r),this.startAutoRefresh(t,"auth",r),e.a(2,n.data);case 3:throw new Error(n.message||"Erreur lors de la génération du QR code");case 4:e.n=6;break;case 5:throw e.p=5,i=e.v,this.handleError(i),i;case 6:return e.a(2)}},e,this,[[1,5]])})),function(e){return h.apply(this,arguments)})},{key:"generateKYCQR",value:(f=t(a().m(function e(t){var r,n,i,u=arguments;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=u.length>1&&void 0!==u[1]?u[1]:{},this.isInitialized){e.n=1;break}throw new Error("SunuID: SDK non initialisé");case 1:return e.p=1,e.n=2,this.makeRequest("/auth/qr-generate.php",o({type:"kyc"},r));case 2:if(!(n=e.v).success){e.n=3;break}return this.displayQRCode(t,n.data.qrCodeUrl,"kyc",r),this.startAutoRefresh(t,"kyc",r),e.a(2,n.data);case 3:throw new Error(n.message||"Erreur lors de la génération du QR code KYC");case 4:e.n=6;break;case 5:throw e.p=5,i=e.v,this.handleError(i),i;case 6:return e.a(2)}},e,this,[[1,5]])})),function(e){return f.apply(this,arguments)})},{key:"checkQRStatus",value:(l=t(a().m(function e(t){var r,n;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.isInitialized){e.n=1;break}throw new Error("SunuID: SDK non initialisé");case 1:return e.p=1,e.n=2,this.makeRequest("/auth/qr-status.php",{sessionId:t});case 2:if(!(r=e.v).success){e.n=3;break}return e.a(2,r.data);case 3:throw new Error(r.message||"Erreur lors de la vérification du statut");case 4:e.n=6;break;case 5:throw e.p=5,n=e.v,this.handleError(n),n;case 6:return e.a(2)}},e,this,[[1,5]])})),function(e){return l.apply(this,arguments)})},{key:"displayQRCode",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=document.getElementById(e);if(!i)throw new Error("Conteneur avec l'ID \"".concat(e,'" non trouvé'));i.innerHTML="";var o=document.createElement("div");o.className="sunuid-qr-code",o.innerHTML='\n                <div class="sunuid-qr-header">\n                    <h3>'.concat("auth"===r?"Authentification":"Vérification KYC",'</h3>\n                    <div class="sunuid-timer">\n                        <span>Expire dans: </span>\n                        <span id="sunuid-timer">30</span>\n                        <span> secondes</span>\n                    </div>\n                </div>\n                <div class="sunuid-qr-image">\n                    <img src="').concat(t,'" alt="QR Code SunuID" style="max-width: 300px; height: auto;">\n                </div>\n                <div class="sunuid-qr-instructions">\n                    <p>Scannez ce QR code avec l\'application SunuID pour vous connecter</p>\n                </div>\n                <div class="sunuid-qr-status" id="sunuid-status">\n                    <p>En attente de scan...</p>\n                </div>\n            '),i.appendChild(o),this.startTimer(),this.applyTheme(n.theme||this.config.theme)}},{key:"refreshQR",value:(c=t(a().m(function e(t,r){var n,i,o,u,s=arguments;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=s.length>2&&void 0!==s[2]?s[2]:{},e.p=1,"auth"!==r){e.n=3;break}return e.n=2,this.generateAuthQR(t,n);case 2:o=e.v,e.n=5;break;case 3:return e.n=4,this.generateKYCQR(t,n);case 4:o=e.v;case 5:return i=o,e.a(2,i);case 6:throw e.p=6,u=e.v,this.handleError(u),u;case 7:return e.a(2)}},e,this,[[1,6]])})),function(e,t){return c.apply(this,arguments)})},{key:"startAutoRefresh",value:function(e,r,n){var i=this;this.config.autoRefresh&&(this.refreshTimer=setInterval(t(a().m(function t(){var o;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,i.refreshQR(e,r,n);case 1:t.n=3;break;case 2:t.p=2,o=t.v,console.warn("Erreur lors du rafraîchissement automatique:",o);case 3:return t.a(2)}},t,null,[[0,2]])})),this.config.refreshInterval))}},{key:"startTimer",value:function(){var e=this,t=30,r=document.getElementById("sunuid-timer"),n=setInterval(function(){t--,r&&(r.textContent=t),t<=0&&(clearInterval(n),e.config.onExpired&&e.config.onExpired())},1e3)}},{key:"makeRequest",value:(s=t(a().m(function e(t,r){var n,i,o,u,s,c;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:return n="".concat(this.config.apiUrl).concat(t),e.p=1,e.n=2,fetch(n,{method:"POST",headers:{"Content-Type":"application/json","X-SunuID-Client-ID":this.config.clientId,"X-SunuID-Secret-ID":this.config.secretId,"X-SunuID-Partner-ID":this.config.partnerId,Accept:"application/json"},body:JSON.stringify(r)});case 2:if((i=e.v).ok){e.n=4;break}return e.n=3,i.text();case 3:o=e.v;try{u=JSON.parse(o)}catch(e){u={message:o}}throw new Error(u.message||"Erreur HTTP: ".concat(i.status));case 4:return e.n=5,i.json();case 5:return s=e.v,e.a(2,s);case 6:throw e.p=6,c=e.v,console.error("Erreur API SunuID:",c),c;case 7:return e.a(2)}},e,this,[[1,6]])})),function(e,t){return s.apply(this,arguments)})},{key:"applyTheme",value:function(e){var t=document.querySelector(".sunuid-qr-code");t&&(t.className="sunuid-qr-code sunuid-theme-".concat(e))}},{key:"handleError",value:function(e){console.error("SunuID SDK Error:",e),this.config.onError&&this.config.onError(e)}},{key:"destroy",value:function(){this.refreshTimer&&clearInterval(this.refreshTimer),this.isInitialized=!1,console.log("SunuID SDK détruit")}}],i&&r(e.prototype,i),u&&r(e,u),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,i,u,s,c,l,f,h}();e.SunuID=i,e.sunuidInstance=null,e.initSunuID=function(t){try{return e.sunuidInstance=new i(t),e.sunuidInstance}catch(e){throw console.error("Erreur lors de l'initialisation de SunuID:",e),e}}}(window)}();
//# sourceMappingURL=sunuid-sdk.min.js.map
