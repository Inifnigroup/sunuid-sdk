!function(){"use strict";function e(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function t(t){return function(){var n=this,r=arguments;return new Promise(function(i,o){var a=t.apply(n,r);function s(t){e(a,i,o,s,c,"next",t)}function c(t){e(a,i,o,s,c,"throw",t)}s(void 0)})}}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function r(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function a(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var a=r&&r.prototype instanceof u?r:u,l=Object.create(a.prototype);return s(l,"_invoke",function(n,r,i){var o,a,s,u=0,l=i||[],f=!1,h={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return o=t,a=0,s=e,h.n=n,c}};function d(n,r){for(a=n,s=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,o=l[t],d=h.p,p=o[2];n>3?(i=p===r)&&(s=o[(a=o[4])?5:(a=3,3)],o[4]=o[5]=e):o[0]<=d&&((i=n<2&&d<o[1])?(a=0,h.v=r,h.n=o[1]):d<p&&(i=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,h.n=p,a=0))}if(i||n>1)return c;throw f=!0,r}return function(i,l,p){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,p),a=l,s=p;(t=a<2?e:s)||!f;){o||(a?a<3?(a>1&&(h.n=-1),d(a,s)):h.n=s:h.v=s);try{if(u=2,o){if(a||(i="next"),t=o[i]){if(!(t=t.call(o,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,a<2&&(a=0)}else 1===a&&(t=o.return)&&t.call(o),a<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),a=1);o=e}else if((t=(f=h.n<0)?s:n.call(r,h))!==c)break}catch(t){o=e,a=1,s=t}finally{u=1}}return{value:t,done:f}}}(n,i,o),!0),l}var c={};function u(){}function l(){}function f(){}t=Object.getPrototypeOf;var h=[][r]?t(t([][r]())):(s(t={},r,function(){return this}),t),d=f.prototype=u.prototype=Object.create(h);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,s(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=f,s(d,"constructor",f),s(f,"constructor",l),l.displayName="GeneratorFunction",s(f,i,"GeneratorFunction"),s(d),s(d,i,"Generator"),s(d,r,function(){return this}),s(d,"toString",function(){return"[object Generator]"}),(a=function(){return{w:o,m:p}})()}function s(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}s=function(e,t,n,r){function o(t,n){s(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},s(e,t,n,r)}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}
/**
   * SunuID SDK - Package d'int√©gration pour partenaires
   * 
   * @version 1.0.0
   * @author SunuID Team
   * @license MIT
   */!function(e){var r={apiUrl:"https://sunuid.fayma.sn/api",clientId:null,secretId:null,theme:"light",language:"fr",autoRefresh:!0,refreshInterval:3e4,onSuccess:null,onError:null,onExpired:null},i=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=o(o({},r),t),this.qrCode=null,this.refreshTimer=null,this.isInitialized=!1,this.init()},i=[{key:"init",value:function(){if(!this.config.clientId||!this.config.secretId)throw new Error("SunuID: clientId et secretId sont requis");this.isInitialized=!0,console.log("SunuID SDK initialis√© avec succ√®s")}},{key:"generateAuthQR",value:(h=t(a().m(function e(t){var n,r,i,s,c,u,l=arguments;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:{},this.isInitialized){e.n=1;break}throw new Error("SunuID: SDK non initialis√©");case 1:return e.p=1,e.n=2,this.makeRequest("/auth/qr-generate",o({type:"auth"},n));case 2:if(!(r=e.v).success){e.n=3;break}return this.displayQRCode(t,r.data.qr_code_url,"auth",n),this.startAutoRefresh(t,"auth",n),e.a(2,r.data);case 3:throw new Error(r.message);case 4:e.n=6;break;case 5:return e.p=5,u=e.v,console.warn("Erreur API, g√©n√©ration d'un QR code de test:",u.message),i=o({type:"auth",clientId:this.config.clientId,timestamp:Date.now(),sessionId:"test_"+Math.random().toString(36).substr(2,9),apiUrl:this.config.apiUrl},n),s=JSON.stringify(i),c="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=".concat(encodeURIComponent(s)),this.displayQRCode(t,c,"auth",n),this.startAutoRefresh(t,"auth",n),e.a(2,{success:!0,data:{qr_code_url:c,qr_id:i.sessionId,expires_at:Date.now()+3e4}});case 6:return e.a(2)}},e,this,[[1,5]])})),function(e){return h.apply(this,arguments)})},{key:"generateKYCQR",value:(f=t(a().m(function e(t){var n,r,i,s,c,u,l=arguments;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:{},this.isInitialized){e.n=1;break}throw new Error("SunuID: SDK non initialis√©");case 1:return e.p=1,e.n=2,this.makeRequest("/auth/qr-generate",o({type:"kyc"},n));case 2:if(!(r=e.v).success){e.n=3;break}return this.displayQRCode(t,r.data.qr_code_url,"kyc",n),this.startAutoRefresh(t,"kyc",n),e.a(2,r.data);case 3:throw new Error(r.message);case 4:e.n=6;break;case 5:return e.p=5,u=e.v,console.warn("Erreur API, g√©n√©ration d'un QR code de test:",u.message),i=o({type:"kyc",clientId:this.config.clientId,timestamp:Date.now(),sessionId:"test_"+Math.random().toString(36).substr(2,9),kycType:n.kycType||"full",requiredFields:n.requiredFields||["identity","address","phone"],apiUrl:this.config.apiUrl},n),s=JSON.stringify(i),c="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=".concat(encodeURIComponent(s)),this.displayQRCode(t,c,"kyc",n),this.startAutoRefresh(t,"kyc",n),e.a(2,{success:!0,data:{qr_code_url:c,qr_id:i.sessionId,expires_at:Date.now()+3e4}});case 6:return e.a(2)}},e,this,[[1,5]])})),function(e){return f.apply(this,arguments)})},{key:"checkQRStatus",value:(l=t(a().m(function e(t){var n,r;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.makeRequest("/auth/qr-status",{qr_id:t});case 1:return n=e.v,e.a(2,n.data);case 2:throw e.p=2,r=e.v,this.handleError(r),r;case 3:return e.a(2)}},e,this,[[0,2]])})),function(e){return l.apply(this,arguments)})},{key:"displayQRCode",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=document.getElementById(e);if(!i)throw new Error("Conteneur avec l'ID \"".concat(e,'" non trouv√©'));var o=r.theme||this.config.theme;r.language||this.config.language,i.innerHTML='\n                <div class="sunuid-qr-container sunuid-theme-'.concat(o,'">\n                    <div class="sunuid-qr-header">\n                        <h3 class="sunuid-qr-title">\n                            ').concat("auth"===n?"üîê Authentification":"üìã V√©rification KYC",'\n                        </h3>\n                        <p class="sunuid-qr-subtitle">\n                            ').concat("auth"===n?"Scannez ce QR code avec l'application SunuID pour vous connecter":"Scannez ce QR code avec l'application SunuID pour compl√©ter votre profil",'\n                        </p>\n                    </div>\n                    <div class="sunuid-qr-code">\n                        <img src="').concat(t,'" alt="QR Code SunuID" class="sunuid-qr-image">\n                        <div class="sunuid-qr-overlay">\n                            <div class="sunuid-qr-spinner"></div>\n                        </div>\n                    </div>\n                    <div class="sunuid-qr-footer">\n                        <p class="sunuid-qr-timer">\n                            <i class="fa-solid fa-clock"></i>\n                            <span id="sunuid-timer">30</span> secondes\n                        </p>\n                        <button class="sunuid-qr-refresh" onclick="sunuidInstance.refreshQR(\'').concat(e,"', '").concat(n,"', ").concat(JSON.stringify(r),')">\n                            <i class="fa-solid fa-sync-alt"></i>\n                            Actualiser\n                        </button>\n                    </div>\n                </div>\n            '),this.qrCode={containerId:e,type:n,options:r,qrUrl:t},this.startTimer()}},{key:"refreshQR",value:(u=t(a().m(function e(t,n){var r,i,o=arguments;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=o.length>2&&void 0!==o[2]?o[2]:{},e.p=1,"auth"!==n){e.n=3;break}return e.n=2,this.generateAuthQR(t,r);case 2:e.n=4;break;case 3:return e.n=4,this.generateKYCQR(t,r);case 4:e.n=6;break;case 5:e.p=5,i=e.v,this.handleError(i);case 6:return e.a(2)}},e,this,[[1,5]])})),function(e,t){return u.apply(this,arguments)})},{key:"startAutoRefresh",value:function(e,n,r){var i=this;this.config.autoRefresh&&(this.refreshTimer=setInterval(t(a().m(function t(){var o;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,i.refreshQR(e,n,r);case 1:t.n=3;break;case 2:t.p=2,o=t.v,console.warn("Erreur lors du rafra√Æchissement automatique:",o);case 3:return t.a(2)}},t,null,[[0,2]])})),this.config.refreshInterval))}},{key:"startTimer",value:function(){var e=this,t=30,n=document.getElementById("sunuid-timer"),r=setInterval(function(){t--,n&&(n.textContent=t),t<=0&&(clearInterval(r),e.config.onExpired&&e.config.onExpired())},1e3)}},{key:"makeRequest",value:(c=t(a().m(function e(t,n){var r,i;return a().w(function(e){for(;;)switch(e.n){case 0:return r="".concat(this.config.apiUrl).concat(t),e.n=1,fetch(r,{method:"POST",headers:{"Content-Type":"application/json","X-SunuID-Client-ID":this.config.clientId,"X-SunuID-Secret-ID":this.config.secretId},body:JSON.stringify(n)});case 1:if((i=e.v).ok){e.n=2;break}throw new Error("Erreur HTTP: ".concat(i.status));case 2:return e.n=3,i.json();case 3:return e.a(2,e.v)}},e,this)})),function(e,t){return c.apply(this,arguments)})},{key:"handleError",value:function(e){console.error("SunuID SDK Error:",e),this.config.onError&&this.config.onError(e)}},{key:"destroy",value:function(){this.refreshTimer&&clearInterval(this.refreshTimer),this.isInitialized=!1,console.log("SunuID SDK d√©truit")}}],i&&n(e.prototype,i),s&&n(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,i,s,c,u,l,f,h}();e.SunuID=i,e.sunuidInstance=null,e.initSunuID=function(t){try{return e.sunuidInstance=new i(t),e.sunuidInstance}catch(e){throw console.error("Erreur lors de l'initialisation de SunuID:",e),e}}}(window)}();
//# sourceMappingURL=sunuid-sdk.min.js.map
