{"version":3,"file":"sunuid-sdk.min.js","sources":["../src/sunuid-sdk.js"],"sourcesContent":["/**\n * SunuID SDK - Package d'int√©gration pour partenaires\n * \n * @version 1.0.0\n * @author SunuID Team\n * @license MIT\n */\n\n(function(window) {\n    'use strict';\n\n    // Configuration par d√©faut\n    const DEFAULT_CONFIG = {\n        apiUrl: window.SunuIDConfig?.apiUrl || 'https://api.sunuid.fayma.sn',\n        clientId: null,\n        secretId: null,\n        type: 1, // Type par d√©faut (1 = authentification)\n        theme: 'light',\n        language: 'fr',\n        autoRefresh: true,\n        refreshInterval: 30000, // 30 secondes\n        onSuccess: null,\n        onError: null,\n        onStatusUpdate: null,\n        onExpired: null\n    };\n\n    /**\n     * Classe principale SunuID\n     */\n    class SunuID {\n        constructor(config = {}) {\n            this.config = { ...DEFAULT_CONFIG, ...config };\n            this.qrCode = null;\n            this.refreshTimer = null;\n            this.isInitialized = false;\n            this.socket = null;\n            this.websocketRetryCount = 0;\n            this.maxWebSocketRetries = 5;\n            \n            this.init();\n        }\n\n        /**\n         * Initialisation du SDK\n         */\n        init() {\n            if (!this.config.clientId || !this.config.secretId) {\n                throw new Error('SunuID: clientId et secretId sont requis');\n            }\n\n            this.isInitialized = true;\n            console.log('SunuID SDK initialis√© avec succ√®s');\n            \n            // Initialiser la connexion WebSocket\n            this.initWebSocket();\n        }\n\n        /**\n         * Initialiser la connexion WebSocket\n         */\n        initWebSocket() {\n            try {\n                // V√©rifier si Socket.IO est disponible\n                if (typeof io === 'undefined') {\n                    this.websocketRetryCount++;\n                    \n                    if (this.websocketRetryCount <= this.maxWebSocketRetries) {\n                        console.warn(`‚ö†Ô∏è Socket.IO non disponible (tentative ${this.websocketRetryCount}/${this.maxWebSocketRetries}), WebSocket sera initialis√© plus tard`);\n                        // R√©essayer apr√®s un d√©lai\n                        setTimeout(() => this.initWebSocket(), 1000);\n                    } else {\n                        console.warn('‚ö†Ô∏è Socket.IO non disponible apr√®s plusieurs tentatives, WebSocket d√©sactiv√©');\n                    }\n                    return;\n                }\n                \n                // Obtenir l'IP du client (simulation)\n                const ip = this.getClientIP();\n                \n                // Initialiser la connexion WebSocket si elle n'existe pas\n                if (!this.socket) {\n                    this.socket = io('wss://samasocket.fayma.sn:9443', {\n                        query: {\n                            token: this.config.clientId,\n                            type: 'web',\n                            userId: this.config.clientId,\n                            username: ip\n                        }\n                    });\n\n                    // Gestion des √©v√©nements WebSocket\n                    this.socket.on('connect', () => {\n                        console.log('üåê WebSocket connect√© avec succ√®s');\n                        console.log('üìä Socket ID:', this.socket.id);\n                    });\n\n                    this.socket.on('disconnect', (reason) => {\n                        console.log('‚ùå WebSocket d√©connect√©:', reason);\n                    });\n\n                    this.socket.on('connect_error', (error) => {\n                        console.error('‚ùå Erreur connexion WebSocket:', error);\n                    });\n\n                    // √âcouter les √©v√©nements sp√©cifiques\n                    this.socket.on('qr_status_update', (data) => {\n                        console.log('üì± Mise √† jour statut QR re√ßue:', data);\n                        this.handleQRStatusUpdate(data);\n                    });\n\n                    this.socket.on('qr_scan_success', (data) => {\n                        console.log('‚úÖ Scan QR r√©ussi re√ßu:', data);\n                        this.handleQRScanSuccess(data);\n                    });\n\n                    this.socket.on('qr_expired', (data) => {\n                        console.log('‚è∞ QR expir√© re√ßu:', data);\n                        this.handleQRExpired(data);\n                    });\n                }\n            } catch (error) {\n                console.error('‚ùå Erreur initialisation WebSocket:', error);\n            }\n        }\n\n        /**\n         * Obtenir l'IP du client (simulation)\n         */\n        getClientIP() {\n            // Simulation - en production, vous pourriez utiliser un service d'IP\n            return '127.0.0.1';\n        }\n\n        /**\n         * G√©rer la mise √† jour du statut QR\n         */\n        handleQRStatusUpdate(data) {\n            if (this.config.onStatusUpdate) {\n                this.config.onStatusUpdate(data);\n            }\n        }\n\n        /**\n         * G√©rer le succ√®s du scan QR\n         */\n        handleQRScanSuccess(data) {\n            if (this.config.onSuccess) {\n                this.config.onSuccess(data);\n            }\n        }\n\n        /**\n         * G√©rer l'expiration du QR\n         */\n        handleQRExpired(data) {\n            if (this.config.onExpired) {\n                this.config.onExpired(data);\n            }\n        }\n\n        /**\n         * √âmettre un √©v√©nement WebSocket\n         */\n        emitWebSocketEvent(event, data) {\n            if (this.socket && this.socket.connected) {\n                this.socket.emit(event, data);\n                console.log(`üì§ √âv√©nement WebSocket √©mis: ${event}`, data);\n            } else if (typeof io === 'undefined') {\n                console.warn('‚ö†Ô∏è Socket.IO non disponible, impossible d\\'√©mettre l\\'√©v√©nement:', event);\n            } else {\n                console.warn('‚ö†Ô∏è WebSocket non connect√©, impossible d\\'√©mettre l\\'√©v√©nement:', event);\n            }\n        }\n\n        /**\n         * Obtenir le statut de la connexion WebSocket\n         */\n        getWebSocketStatus() {\n            if (!this.socket) {\n                return 'not_initialized';\n            }\n            return this.socket.connected ? 'connected' : 'disconnected';\n        }\n\n        /**\n         * Forcer l'initialisation WebSocket (si Socket.IO devient disponible plus tard)\n         */\n        forceWebSocketInit() {\n            if (typeof io !== 'undefined' && !this.socket) {\n                console.log('üîÑ For√ßage de l\\'initialisation WebSocket...');\n                this.initWebSocket();\n            }\n        }\n\n        /**\n         * G√©n√©rer un QR code avec le type configur√©\n         */\n        async generateQR(containerId, options = {}) {\n            if (!this.isInitialized) {\n                throw new Error('SunuID: SDK non initialis√©');\n            }\n\n            try {\n                const response = await this.makeRequest('/qr-generate', {\n                    type: this.config.type, // Utilise le type configur√©\n                    ...options\n                });\n\n                if (response.success) {\n                    // Construire l'URL compl√®te de l'image QR avec la base URL pour les images\n                    const imageBaseUrl = 'https://sunuid.fayma.sn';\n                    const qrImageUrl = `${imageBaseUrl}${response.data.qrcode}`;\n                    this.displayQRCode(containerId, qrImageUrl, this.config.type, options);\n                    this.startAutoRefresh(containerId, this.config.type, options);\n                    \n                    // √âmettre un √©v√©nement WebSocket pour la g√©n√©ration du QR\n                    this.emitWebSocketEvent('qr_generated', {\n                        serviceId: response.data.service_id,\n                        type: this.config.type,\n                        qrCodeUrl: qrImageUrl,\n                        timestamp: Date.now()\n                    });\n                    \n                    return {\n                        ...response.data,\n                        qrCodeUrl: qrImageUrl,\n                        sessionId: response.data.service_id\n                    };\n                } else {\n                    throw new Error(response.message || 'Erreur lors de la g√©n√©ration du QR code');\n                }\n            } catch (error) {\n                console.error('Erreur API d√©tect√©e:', error.message);\n                console.log('Affichage du message \"Service non disponible\" pour type ' + this.config.type);\n                this.displayServiceUnavailable(containerId, this.config.type);\n                throw new Error('Service non disponible');\n            }\n        }\n\n\n\n        /**\n         * G√©n√©rer un QR code avec un type personnalis√©\n         */\n        async generateCustomQR(containerId, type, options = {}) {\n            if (!this.isInitialized) {\n                throw new Error('SunuID: SDK non initialis√©');\n            }\n\n            try {\n                const response = await this.makeRequest('/qr-generate', {\n                    type: type, // Type personnalis√© (1, 2, 3, etc.)\n                    ...options\n                });\n\n                if (response.success) {\n                    // Construire l'URL compl√®te de l'image QR avec la base URL pour les images\n                    const imageBaseUrl = 'https://sunuid.fayma.sn';\n                    const qrImageUrl = `${imageBaseUrl}${response.data.qrcode}`;\n                    this.displayQRCode(containerId, qrImageUrl, type, options);\n                    this.startAutoRefresh(containerId, type, options);\n                    return {\n                        ...response.data,\n                        qrCodeUrl: qrImageUrl,\n                        sessionId: response.data.service_id\n                    };\n                } else {\n                    throw new Error(response.message || 'Erreur lors de la g√©n√©ration du QR code');\n                }\n            } catch (error) {\n                console.error('Erreur API d√©tect√©e:', error.message);\n                console.log('Affichage du message \"Service non disponible\" pour type ' + type);\n                this.displayServiceUnavailable(containerId, type);\n                throw new Error('Service non disponible');\n            }\n        }\n\n        // Alias pour maintenir la compatibilit√©\n        async generateAuthQR(containerId, options = {}) {\n            return this.generateQR(containerId, options);\n        }\n\n        async generateKYCQR(containerId, options = {}) {\n            // Sauvegarder le type actuel\n            const originalType = this.config.type;\n            // Changer temporairement le type pour KYC\n            this.config.type = 2;\n            try {\n                return await this.generateQR(containerId, options);\n            } finally {\n                // Restaurer le type original\n                this.config.type = originalType;\n            }\n        }\n\n        /**\n         * V√©rifier le statut d'un QR code\n         */\n        async checkQRStatus(sessionId) {\n            if (!this.isInitialized) {\n                throw new Error('SunuID: SDK non initialis√©');\n            }\n\n            try {\n                const response = await this.makeRequest('/qr-status', {\n                    serviceId: sessionId\n                });\n\n                if (response.success) {\n                    return response.data;\n                } else {\n                    throw new Error(response.message || 'Erreur lors de la v√©rification du statut');\n                }\n            } catch (error) {\n                this.handleError(error);\n                throw error;\n            }\n        }\n\n        /**\n         * Afficher un QR code dans un conteneur\n         */\n        displayQRCode(containerId, qrUrl, type, options = {}) {\n            const container = document.getElementById(containerId);\n            if (!container) {\n                throw new Error(`Conteneur avec l'ID \"${containerId}\" non trouv√©`);\n            }\n\n            // Nettoyer le conteneur\n            container.innerHTML = '';\n\n            // Cr√©er l'√©l√©ment QR code\n            const qrElement = document.createElement('div');\n            qrElement.className = 'sunuid-qr-code';\n            qrElement.innerHTML = `\n                    <div class=\"sunuid-qr-header\">\n                    <h3>${type === 1 ? 'Authentification' : type === 2 ? 'V√©rification KYC' : type === 3 ? 'Service Type 3' : 'Service Type ' + type}</h3>\n                    </div>\n                <div class=\"sunuid-qr-image\">\n                    <img src=\"${qrUrl}\" alt=\"QR Code SunuID\" style=\"max-width: 300px; height: auto;\">\n                    </div>\n                <div class=\"sunuid-qr-instructions\">\n                    <p>Scannez ce QR code avec l'application SunuID pour vous connecter</p>\n                    </div>\n                <div class=\"sunuid-qr-status\" id=\"sunuid-status\">\n                    <p>En attente de scan...</p>\n                </div>\n            `;\n\n            container.appendChild(qrElement);\n\n            // Appliquer le th√®me\n            this.applyTheme(options.theme || this.config.theme);\n        }\n\n        /**\n         * Afficher \"Service non disponible\"\n         */\n        displayServiceUnavailable(containerId, type) {\n            console.log(`displayServiceUnavailable appel√©e pour ${containerId}, type: ${type}`);\n            const container = document.getElementById(containerId);\n            if (!container) {\n                console.error(`Container ${containerId} non trouv√©`);\n                return;\n            }\n\n            container.innerHTML = `\n                <div class=\"sunuid-service-unavailable\" style=\"\n                    text-align: center;\n                    padding: 40px 20px;\n                    background: #f8f9fa;\n                    border: 2px dashed #dee2e6;\n                    border-radius: 10px;\n                    color: #6c757d;\n                    font-family: Arial, sans-serif;\n                \">\n                    <div style=\"font-size: 48px; margin-bottom: 20px;\">‚ö†Ô∏è</div>\n                    <h3 style=\"margin: 0 0 10px 0; color: #495057;\">Service Non Disponible</h3>\n                    <p style=\"margin: 0; font-size: 14px;\">\n                        Le service d'authentification est temporairement indisponible.<br>\n                        Veuillez r√©essayer plus tard.\n                    </p>\n                    <div style=\"margin-top: 20px; font-size: 12px; color: #adb5bd;\">\n                        Type: ${type.toUpperCase()}\n                    </div>\n                </div>\n            `;\n        }\n\n        /**\n         * Rafra√Æchir un QR code\n         */\n        async refreshQR(containerId, options = {}) {\n            try {\n                const result = await this.generateQR(containerId, options);\n                return result;\n            } catch (error) {\n                console.error('Erreur lors du rafra√Æchissement:', error.message);\n                this.displayServiceUnavailable(containerId, this.config.type);\n                throw error;\n            }\n        }\n\n        /**\n         * D√©marrer le rafra√Æchissement automatique\n         */\n        startAutoRefresh(containerId, type, options) {\n            if (!this.config.autoRefresh) return;\n\n            this.refreshTimer = setInterval(async () => {\n                try {\n                    await this.refreshQR(containerId, type, options);\n                } catch (error) {\n                    console.warn('Erreur lors du rafra√Æchissement automatique:', error);\n                }\n            }, this.config.refreshInterval);\n        }\n\n        /**\n         * D√©marrer le timer de compte √† rebours\n         */\n\n\n        /**\n         * Effectuer une requ√™te API\n         */\n        async makeRequest(endpoint, data) {\n            // Utiliser l'endpoint depuis la configuration si disponible\n            const endpointPath = window.SunuIDConfig?.endpoints?.[endpoint.replace('/', '')] || endpoint;\n            const url = `${this.config.apiUrl}${endpointPath}`;\n            \n            // Log pour d√©boguer l'envoi du type\n            if (data.type !== undefined) {\n                console.log(`üåê Envoi requ√™te API - Type: ${data.type}, Endpoint: ${endpoint}`);\n            }\n            \n            try {\n                const response = await fetch(url, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Authorization': `Bearer ${this.config.clientId}:${this.config.secretId}`,\n                        'Accept': 'application/json'\n                    },\n                    body: JSON.stringify({\n                        ...data,\n                        client_id: this.config.clientId,\n                        secret_id: this.config.secretId\n                    })\n                });\n\n                if (!response.ok) {\n                    const errorText = await response.text();\n                    let errorData;\n                    try {\n                        errorData = JSON.parse(errorText);\n                    } catch (e) {\n                        errorData = { message: errorText };\n                    }\n                    \n                    throw new Error(errorData.message || `Erreur HTTP: ${response.status}`);\n                }\n\n                const result = await response.json();\n                return result;\n            } catch (error) {\n                console.error('Erreur API SunuID:', error);\n                throw error;\n            }\n        }\n\n        /**\n         * Appliquer le th√®me\n         */\n        applyTheme(theme) {\n            const container = document.querySelector('.sunuid-qr-code');\n            if (container) {\n                container.className = `sunuid-qr-code sunuid-theme-${theme}`;\n            }\n        }\n\n        /**\n         * G√©rer les erreurs\n         */\n        handleError(error) {\n            console.error('SunuID SDK Error:', error);\n            \n            if (this.config.onError) {\n                this.config.onError(error);\n            }\n        }\n\n        /**\n         * Nettoyer les ressources\n         */\n        destroy() {\n            if (this.refreshTimer) {\n                clearInterval(this.refreshTimer);\n            }\n            \n            // Fermer la connexion WebSocket\n            if (this.socket) {\n                this.socket.disconnect();\n                this.socket = null;\n                console.log('üåê WebSocket d√©connect√©');\n            }\n            \n            this.isInitialized = false;\n            console.log('SunuID SDK d√©truit');\n        }\n    }\n\n    // Exposer la classe globalement\n    window.SunuID = SunuID;\n    window.sunuidInstance = null;\n\n    // Fonction d'initialisation globale\n    window.initSunuID = function(config) {\n        try {\n            window.sunuidInstance = new SunuID(config);\n            return window.sunuidInstance;\n        } catch (error) {\n            console.error('Erreur lors de l\\'initialisation de SunuID:', error);\n            throw error;\n        }\n    };\n\n})(window); "],"names":["window","_window$SunuIDConfig","DEFAULT_CONFIG","apiUrl","SunuIDConfig","clientId","secretId","type","theme","language","autoRefresh","refreshInterval","onSuccess","onError","onStatusUpdate","onExpired","SunuID","config","arguments","length","undefined","_classCallCheck","this","_objectSpread","qrCode","refreshTimer","isInitialized","socket","websocketRetryCount","maxWebSocketRetries","init","key","value","Error","console","log","initWebSocket","_this","io","warn","concat","setTimeout","ip","getClientIP","query","token","userId","username","on","id","reason","error","data","handleQRStatusUpdate","handleQRScanSuccess","handleQRExpired","event","connected","emit","_generateQR","_asyncToGenerator","_regenerator","m","_callee","containerId","options","response","qrImageUrl","_t","_args","w","_context","p","n","makeRequest","v","success","qrcode","displayQRCode","startAutoRefresh","emitWebSocketEvent","serviceId","service_id","qrCodeUrl","timestamp","Date","now","a","sessionId","message","displayServiceUnavailable","_x","apply","_generateCustomQR","_callee2","_t2","_args2","_context2","_x2","_x3","_generateAuthQR","_callee3","_args3","_context3","generateQR","_x4","_generateKYCQR","_callee4","originalType","_args4","_context4","f","_x5","_checkQRStatus","_callee5","_t3","_context5","handleError","_x6","qrUrl","container","document","getElementById","innerHTML","qrElement","createElement","className","appendChild","applyTheme","toUpperCase","_refreshQR","_callee6","result","_t4","_args6","_context6","_x7","_this2","setInterval","_callee7","_t5","_context7","refreshQR","_makeRequest","_callee8","endpoint","_window$SunuIDConfig2","endpointPath","url","errorText","errorData","_t6","_context8","endpoints","replace","fetch","method","headers","Authorization","Accept","body","JSON","stringify","client_id","secret_id","ok","text","parse","e","status","json","_x8","_x9","querySelector","clearInterval","disconnect","sunuidInstance","initSunuID"],"mappings":"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"}